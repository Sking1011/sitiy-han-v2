# Ролевая модель и Безопасность

## Роли пользователей

### 1. ADMIN (Администратор)
- **Доступ:** Полный (God Mode).
- **Функции:**
  - Управление пользователями (создание, удаление, смена паролей).
  - Технические настройки (бэкапы, логи, настройки сервера).
  - Все функции Директора.

### 2. DIRECTOR (Директор)
- **Доступ:** Полный бизнес-доступ.
- **Функции:**
  - **Финансы:** Видит выручку, прибыль, себестоимость, зарплаты.
  - **Склад:** Полное управление товарами, ценами закупа.
  - **Категории:** Создание гибкой структуры (Говядина -> Мякоть).
  - **Логи:** Просмотр журнала действий (кто что удалил/изменил).
  - **Производство:** Может создавать и редактировать техкарты.

### 3. OPERATOR (Оператор / Технолог)
- **Доступ:** Ограниченный (Только производство).
- **Ограничение:**
  - ⛔ **НЕТ ДОСТУПА К ДАШБОРДУ.** При входе перенаправляется сразу на `/production`.
  - ⛔ **НЕ ВИДИТ ДЕНЬГИ** (Цены закупа, Себестоимость, Прибыль).
  - ⛔ **НЕ МОЖЕТ МЕНЯТЬ РЕЦЕПТУРУ** при производстве.
- **Функции:**
  - **Склад:** Видит только *количество* (кг, шт) сырья и продукции.
  - **Производство:**
    - Выбирает рецепт и вводит количество готовой продукции.
    - Система автоматически списывает сырье по нормативу.

### 4. ACCOUNTANT (Бухгалтер)
- **Доступ:** Узкоспециализированный.
- **Видит:**
  - ✅ Только страницу "Бухгалтерия" (Отчеты P&L, Движение средств).
  - ✅ Историю продаж и закупок (только чтение, для сверки).
- **Может:**
  - ✅ Экспортировать отчеты в Excel.
- **НЕ Может:**
  - ⛔ Менять ставку налога (только Админ/Директор).
  - ⛔ Менять остатки на складе.
  - ⛔ Управлять пользователями.

## Матрица доступа к страницам

| Страница | ADMIN | DIRECTOR | ACCOUNTANT | OPERATOR |
| :--- | :---: | :---: | :---: | :---: |
| Дашборд (Финансы) | ✅ | ✅ | ✅ | ⛔ |
| Склад (Остатки) | ✅ | ✅ | ⛔ | ✅ |
| Производство | ✅ | ✅ | ⛔ | ✅ |
| Продажи (Ввод) | ✅ | ✅ | ⛔ | ⛔ |
| Бухгалтерия (Отчеты) | ✅ | ✅ | ✅ | ⛔ |
| Настройки (Налоги) | ✅ | ✅ | ⛔ | ⛔ |
| Пользователи | ✅ | ⛔ | ⛔ | ⛔ |
  - **Интерфейс:** Упрощенный, адаптированный под планшет/телефон.

## Система Логирования (Audit Logs)

Система автоматически записывает все критические действия. Логи доступны только Админу и Директору.

**Что логируется:**
1. **Вход в систему:** IP адрес, устройство.
2. **Склад:** Ручное изменение остатков (Корректировка).
3. **Финансы:** Удаление/Изменение продаж или закупок.
4. **Справочники:** Изменение рецептов, удаление категорий.

**Формат лога в интерфейсе:**
> `08.02 14:30` | **Иван (Директор)** | *Изменил рецепт* "Колбаса Докторская" | `Соль: 10г -> 12г`
