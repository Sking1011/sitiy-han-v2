# Технологический стек и стандарты

## Основной стек
- **Language:** TypeScript
- **Framework:** Next.js (App Router)
- **Database:** PostgreSQL
- **ORM:** Prisma or Drizzle
- **Styling:** Tailwind CSS + Shadcn UI
- **State Management:** React Context / TanStack Query
- **Auth:** NextAuth.js or Clerk
- **Infrastructure:** Docker, Docker Compose

## Правила разработки
1. **Оптимизация файлов:** Максимальное количество строк в одном файле — **700 строк**. Если файл превышает 1000 строк, это считается нарушением архитектуры. Необходимо разбивать на мелкие компоненты и хуки.
2. **Типизация:** Строгая типизация всех данных (никаких `any`).
3. **Локализация:** Весь интерфейс на русском языке.
4. **Архитектура:** Четкое разделение на UI-компоненты, Server Actions и бизнес-логику.
5. **Работа с числами:**
   - В БД использовать тип `DECIMAL`.
   - В JS/TS использовать библиотеку `decimal.js` для точных вычислений денег и веса.
6. **Архитектура уведомлений (Подготовка к Telegram Bot):**
   - Используем паттерн **Service Layer**. Вся бизнес-логика (создать продажу, списать товар) лежит в папке `services/`.
   - API Endpoints (`app/api/...`) занимаются только валидацией и вызовом сервисов.
   - Сервисы должны возвращать полные данные о совершенной операции, чтобы в будущем можно было отправить их в Event Bus (систему событий) для Телеграм-бота.
7. **Целостность данных:**
   - Любые операции с остатками (Закуп, Продажа, Производство) ОБЯЗАНЫ выполняться внутри `Prisma.$transaction`.
